#@adminLayout()
#define main()
<ul class="breadcrumb">
    <li><a href="/admin">首页</a></li>
    <li class="active">代码生成</li>
</ul>

<div class="row mb-2">
    <div class="col-md-8">
        <form class="form-inline">
            <div class="form-group">
                <label for="exampleInputName2">表名</label>
                <input type="text" name="name" class="form-control" id="exampleInputName2" placeholder="表名">
            </div>
            <div class="form-group ml-1">
                <label for="exampleInputEmail2">备注</label>
                <input type="text" name="remark" class="form-control" id="exampleInputEmail2" placeholder="表备注">
            </div>
            <button type="submit" class="btn btn-primary ml-1">检索</button>
            <button type="reset" class="btn btn-default">重置</button>
        </form>
    </div>
    <div class="col-md-4">
        <a class="btn btn-primary btn-sm" href="/admin/code/gen">
            生成代码
        </a>
    </div>
</div>

<div class="table-responsive">
    <table class="table table-hover table-bordered">
        <thead>
        <tr>
            <th>表名</th>
            <th>数据库名</th>
            <th>数据行数</th>
            <th>数据库引擎</th>
            <th>备注</th>
            <th>创建时间</th>
            <th>更新时间</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
        #for(x : pageResult.getList())
        <tr>
            <th scope="row">#(x.tableName)</th>
            <td>#(x.databaseName)</td>
            <td>#(x.rows)</td>
            <td>#(x.engineName)</td>
            <td>#(x.remark??)</td>
            <td>#date(x.cTime)</td>
            <td>#date(x.uTime)</td>
            <td>
                #permission("/admin/code/gen")
                <a class="btn btn-primary btn-sm" href="/admin/code/gen?tables=#(x.tableName)">
                    生成代码
                </a>
                #end
            </td>
        </tr>
        #end
        </tbody>
    </table>
    #@adminPaginate(pageResult.totalRow,
    pageResult.pageNumber,
    pageResult.totalPage,
    "/admin/code?name="+ (name == null ? '' : name) +"&remark=" + (remark == null ? '' : remark) + "&p=")
</div>

<script>
    var THIS = {
        genCode: function (event) {
            event.preventDefault();
            var $this = $(this);
            var action = $this.attr("data-action");
            var tableName = $this.attr("data-title");
            Admin.confirmAjaxAction("确定生成【" + tableName + "】表?", action);
        }
    };
    $(document).ready(function () {
        $('#pjax-container').on("click", "a[gen-code]", THIS.genCode);
    });
</script>
#end